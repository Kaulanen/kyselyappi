<!DOCTYPE html>
<html lang="fi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mielipidekysely</title>

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='logo.png') }}">

    <!-- Oma CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <header>
        <img src="{{ url_for('static', filename='logo.png') }}" alt="Logo" id="logo">
        <h1>Mielipidekysely</h1>
    </header>

    <p class="kysymys">Oliko Prodonetin tukipalvelut mielestäsi toimivat?</p>

    <div class="option">
        <input type="radio" id="optionA" name="choice" onclick="confirmSelection()">
        <label for="optionA">Kyllä! Nautin asiakaspalvelusta!</label>
    </div>

    <div class="option">
        <input type="radio" id="optionB" name="choice" onclick="trickUser()">
        <label for="optionB">Ei.</label>
    </div>

    <button class="reset-btn">
        Tyhjennä valinta
    </button>

    <div id="message" class="message"></div>
    <!-- Varmistusmodal -->
    <div id="confirmModal" class="modal">
        <div class="modal-content">
            <p id="confirmMessage">Varmistusviesti tähän</p>
            <button id="confirmYes" class="btn yes">Kyllä</button>
            <button id="confirmNo" class="btn no">Ei</button>
        </div>
    </div>

    <script>
        // Reset-painike
        document.querySelector('.reset-btn').addEventListener('click', resetSelection);

        async function confirmSelection() {
            const messages = [
                "Oletko varma tästä valinnasta?",
                "Tämä on tärkeä päätös. Haluatko jatkaa?",
                "Oletko edelleen samaa mieltä?",
                "Viimeinen varmistus: jatketaanko?",
                "Sinut ohjataan nyt sivulle www.pornhub.com. Haluatko jatkaa?"
            ];

            for (let msg of messages) {
                const ok = await showConfirm(msg);
                if (!ok) {
                    document.getElementById('optionA').checked = false;
                    document.getElementById('message').textContent = "Valinta peruutettu.";
                    return;
                }
            }

            document.getElementById('message').textContent =
                "Kiitos että olet tätä mieltä (Vaihtoehto A)";
        }
        function showConfirm(message) {
            return new Promise((resolve) => {
                const modal = document.getElementById("confirmModal");
                const msgBox = document.getElementById("confirmMessage");
                const yesBtn = document.getElementById("confirmYes");
                const noBtn = document.getElementById("confirmNo");

                msgBox.textContent = message;
                modal.style.display = "flex";

                yesBtn.onclick = () => {
                    modal.style.display = "none";
                    resolve(true);
                };

                noBtn.onclick = () => {
                    modal.style.display = "none";
                    resolve(false);
                };
            });
        }

        function trickUser() {
            document.getElementById('optionB').checked = false;
            document.getElementById('optionA').checked = true;
            document.getElementById('message').textContent =
                "Kiitos, että annat täydet pisteet palvelullemme! Arvostamme mielipidettäsi.";
        }

        function resetSelection() {
            document.getElementById('optionA').checked = false;
            document.getElementById('optionB').checked = false;
            document.getElementById('message').textContent = "Valinta tyhjennetty.";            
        }
    </script>
</body>
</html>
